<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>تغيير كلمة المرور</title>
  <link rel="stylesheet" href="/styles.css" />
  <style>
    .card{max-width:480px;margin:8vh auto;background:#fff;border-radius:14px;padding:1.2rem 1.4rem;box-shadow:0 10px 30px rgba(0,0,0,.06)}
    .card h1{font-size:1.1rem;margin-bottom:.8rem}
    .form-group{margin:.75rem 0}
    .form-group label{display:block;margin-bottom:.25rem}
    .form-group input{width:100%;padding:.7rem;border:1px solid #e5e7eb;border-radius:10px}
    .btn{background:#111;color:#fff;border:none;border-radius:10px;padding:.7rem 1rem;cursor:pointer;margin-top:.8rem}
    .msg{margin-top:.6rem;font-size:.95rem}
    .ok{color:#065f46}
    .err{color:#b91c1c}
    .nav{display:flex;gap:.5rem;align-items:center;margin-bottom:1rem}
    .link{color:#111;text-decoration:underline;cursor:pointer}
  </style>
</head>
<body>
  <nav class="topbar"><div class="container">تغيير كلمة المرور</div></nav>
  <main class="container">
    <div class="nav">
      <a class="link" href="/admin-mobile.html">لوحة الإدارة</a>
      <span>•</span>
      <a class="link" href="/login.html">تسجيل الدخول</a>
    </div>
    <div class="card">
      <h1>غيّر كلمة مرورك</h1>
      <div class="form-group">
        <label>كلمة المرور الحالية</label>
        <input id="current" type="password" autocomplete="current-password">
      </div>
      <div class="form-group">
        <label>كلمة المرور الجديدة</label>
        <input id="next" type="password" autocomplete="new-password">
      </div>
      <button class="btn" id="saveBtn">تحديث</button>
      <div id="msg" class="msg"></div>
    </div>
  </main>
  <script>
  document.getElementById('saveBtn').addEventListener('click', async () => {
    const currentPassword = document.getElementById('current').value;
    const newPassword = document.getElementById('next').value;
    const res = await fetch('/api/auth/change-password', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ currentPassword, newPassword })
    });
    const msg = document.getElementById('msg');
    if(res.ok){
      msg.textContent = 'تم تحديث كلمة المرور بنجاح.';
      msg.className = 'msg ok';
      document.getElementById('current').value = '';
      document.getElementById('next').value = '';
    }else{
      msg.textContent = 'تعذر التحديث — تأكد من كلمة المرور الحالية.';
      msg.className = 'msg err';
    }
  });
  </script>
</body>
</html>
